---
description: learning_Python内のプロジェクト管理についての指示ファイルです。
applyTo: '**'
---

## 概要
- learning_Pythonリポジトリは、はてなブログに投稿するための技術的な探索を扱うプロジェクトです。
- このリポジトリでは、主に開発されたソフトウェアの使用実験や、データ分析手法の検証、関連する技術的・数理的なトピックについての検証や学習を行います。

## 対象ファイル・ディレクトリ
- この指示ファイルは、リポジトリ内のすべてのファイルとディレクトリに適用されます。

## ルール・指示内容

### ディレクトリ構造
- このリポジトリの直下ファイル(`R_Advent_Calendar_20XX`など)を、「プロジェクト」として定義します。
  - 各プロジェクトは独立しており、他のプロジェクトと干渉しないように設計してください。
  - プロジェクト名は、指示する検証内容や技術トピックに関連した名前にしてください。
- プロジェクト内でのパッケージ管理や環境設定は、そのフォルダ内で完結するようにしてください。
  - `renv`や`venv`などの仮想環境を使用して、各プロジェクトの依存関係を管理してください。
  - プロジェクト間での依存関係の共有は避けてください。
- 各プロジェクトごとのディレクトリ構造は、可能な限り共通のパターンで生成します。
  - 例えば、データは`input/`ディレクトリに、スクリプトは`src/`ディレクトリに、出力結果は`output/`ディレクトリに、ドキュメントは`doc/`ディレクトリに配置します。
  - 各ディレクトリの名称には必ず頭にナンバリングを付与してください。
    - 例: `01_input/`, `02_src/`, `03_output/`, `04_doc/`
  - 各プロジェクトのルートディレクトリには、`README.md`ファイルを配置し、プロジェクトの目的、使用方法、依存関係などの基本情報を記載してください。
- 上記の例に限らず、デバッグやテスト、モジュール化などを指示する場合があります。必要に応じて適切なサブディレクトリを作成してください。
- すでに存在するプロジェクトについては修正を加えず、新規プロジェクトに対して上記のルールを適用してください。

### 抽象化のレベル
- 技術的な検証が主な目的であるため、使用するコードはインタラクティブな実験やプロトタイピングに適した形式で提供してください。
  - 原則としてカプセル化やモジュール化は必要ありません。ただし、コードの可読性や再利用性を考慮して、適切なコメントやドキュメンテーションを追加してください。

### 使用する言語
- 主にRとPythonを使用してコードを生成します。
  - Rコードの場合、 `.github/copilot/skills/R_skills.instructions.md` に従ってください。
  - Pythonコードの場合、`.github/copilot/skills/Python_skills.instructions.md` に従ってください。

### 既存プロジェクトのカタログ
このリポジトリには、過去に実施した技術検証のプロジェクトが多数存在しています。新規プロジェクトを作成する際は、以下の既存プロジェクトを参考にして、同様の構造とコーディングスタイルを採用してください。

#### R言語を使用したプロジェクト
- **`causal_inference/`**: 因果推論（Difference-in-Differences、Causal Impact分析）の実装
  - 主要ファイル: `03_source/chp4_did.R`, `03_source/Causal_Imparct.R`
- **`Clustering_Binary_Data/`**: バイナリデータのクラスタリング手法の検証
  - 主要ファイル: `03_source/kmeans_for_binarydata.R`, `03_source/hclust_for_binarydata.R`
- **`R_Advent_Calendar_202X/`**: R Advent Calendar投稿用のプロジェクト群
  - 年次ごとにディレクトリが分かれており、各年の技術トピックを扱っています
- **`stan_hierarchical_model/`**: Stanを用いた階層モデルの実装
  - Rとstanコードの連携例として参考になります

#### Pythonを使用したプロジェクト
- **`MMM_parameter_consistency_test/`**: マーケティングミックスモデル（MMM）のパラメータ一貫性テスト
- **`python_LMMM_trial/`**: Lightweight MMMの実装試行
- **`sudoku_webapp/`**: Flaskを使用した数独Webアプリケーション
  - Webアプリケーション開発の例として参考になります
- **`quantumblack_causalnex/`**: QuantumBlack CausalNexの使用実験

#### その他の特殊なプロジェクト
- **`rstan_training/`**: RStan（StanとRの連携）のトレーニングプロジェクト
- **`trial_GA2M/`**: GA2M（Generalized Additive Model 2）の試行
  - Jupyter NotebookとPythonスクリプトの両方が含まれています

### 新規プロジェクトの作成ワークフロー
新しい技術トピックを探索する際は、以下のワークフローに従ってください：

1. **プロジェクトディレクトリの作成**
   - リポジトリ直下に、トピック名を反映したディレクトリを作成
   - 命名規則: `snake_case`で、内容が明確にわかる名前（例: `causal_inference`, `Clustering_Binary_Data`）

2. **プロジェクトファイルの初期化**
   - Rプロジェクトの場合: `.Rproj`ファイルを作成
   - Pythonプロジェクトの場合: `pyproject.toml`または`requirements.txt`を作成

3. **ディレクトリ構造の構築**
   - ナンバリング付きのサブディレクトリを作成:
     - `01_input/`: 入力データファイル
     - `02_src/` または `src/`: ソースコード
     - `03_output/` または `output/`: 出力結果（グラフ、表、モデルファイルなど）
     - `04_doc/` または `doc/`: ドキュメント、ブログ記事の下書き
   - 必要に応じて、`debug/`, `module/`, `tests/`などのサブディレクトリも追加

4. **README.mdの作成**
   - プロジェクトの目的と概要
   - 使用する主要なパッケージ・ライブラリ
   - 実行方法と依存関係
   - 結果の概要（簡潔に）

5. **コード実装とテスト**
   - スクリプトを段階的に作成（データ生成→前処理→分析→可視化）
   - 各スクリプトには適切なコメントとドキュメンテーションを追加

6. **出力の管理**
   - グラフ: PNG形式で`output/`ディレクトリに保存
   - 数表: CSV形式で`output/`ディレクトリに保存
   - モデルオブジェクト: RDS（R）またはpickle/joblib（Python）形式で保存

7. **ブログ記事の執筆**
   - `doc/`ディレクトリにMarkdown形式で記事を執筆
   - 必要に応じてHTML形式にも変換（R Markdownなどを使用）

### データファイルとパス管理
- **データファイルの配置**: すべての入力データは`01_input/`または`input/`ディレクトリに配置してください
- **パスの指定方法**:
  - Rの場合: `here::here()`パッケージを使用して、プロジェクトルートからの相対パスで指定
  - Pythonの場合: `pathlib.Path`を使用して、プロジェクトルートからの相対パスで指定
  - 絶対パスの使用は避けてください（移植性の観点から）
- **データファイルの命名規則**:
  - 内容が明確にわかる名前をつける
  - 日付やバージョン情報を含める場合は、`YYYY-MM-DD`形式を使用
  - 例: `sales_data_2024-01-15.csv`, `model_results_v2.rds`

### 出力ファイルの管理
- **グラフ・図表の保存**:
  - 形式: PNG（ブログ記事用）、解像度は300dpi以上を推奨
  - ファイル名: 内容を反映した明確な名前（例: `clustering_dendrogram.png`, `did_effect_plot.png`）
- **数値結果の保存**:
  - 形式: CSV（テーブルデータ）、TXT（テキスト形式の結果）
  - ファイル名: 内容と日付を含める（例: `model_summary_2024-01-15.csv`）
- **中間生成物の管理**:
  - 学習済みモデル、大規模なデータ処理結果などは、適切な形式で保存
  - Rの場合: `.rds`形式
  - Pythonの場合: `.pkl`（pickle）または`.joblib`形式

### ドキュメンテーション規約
#### ブログ記事用Markdown
- **見出し構造**: Markdown形式で明確な見出し階層を使用
  - `#`: 記事タイトル
  - `##`: 主要なセクション
  - `###`: サブセクション
- **数式の記述**: LaTeX形式で記述
  - インライン数式: `$E = mc^2$`
  - ディスプレイ数式: `$$\int_{a}^{b} f(x) dx$$`
- **コードブロック**: 言語を明示したコードブロックを使用
  ```python
  # Pythonコードの例
  import pandas as pd
  ```
  ```r
  # Rコードの例
  library(dplyr)
  ```
- **画像の埋め込み**: 相対パスで画像を参照
  ```markdown
  ![クラスタリング結果](../output/clustering_result.png)
  ```

#### README.mdのテンプレート
各プロジェクトのREADME.mdには、以下の情報を含めてください：
```markdown
# プロジェクト名

## 目的
このプロジェクトの目的を1-2文で簡潔に説明

## 使用技術
- 言語: R / Python
- 主要パッケージ: 
  - パッケージ名1 (バージョン)
  - パッケージ名2 (バージョン)

## ディレクトリ構造
- `01_input/`: 入力データ
- `02_src/`: ソースコード
- `03_output/`: 出力結果
- `04_doc/`: ドキュメント

## 実行方法
1. 環境構築の手順
2. スクリプトの実行順序

## 結果
主要な発見や結果を簡潔に記述
```

### テスト駆動開発
- 原則としてテスト駆動開発を採用しますが、技術検証が主目的のため、厳密なテストは必須ではありません
- ただし、以下の場合はテストコードを作成してください：
  - 複雑なデータ処理ロジックを実装する場合
  - 再利用可能な関数やモジュールを作成する場合
  - モデルの妥当性検証が必要な場合
- テストコードの配置:
  - Rの場合: `tests/`ディレクトリに`testthat`を使用したテストコードを配置
  - Pythonの場合: `tests/`ディレクトリに`pytest`を使用したテストコードを配置

### 依存関係の管理
- **プロジェクト間の独立性**: 各プロジェクトは独立しており、プロジェクト間での依存関係は持ちません
- **共通モジュール**: リポジトリルートの`init.R`は、R環境全体の初期設定に使用される可能性があります
  - 新規プロジェクトでは、このファイルに依存しないように設計してください
- **パッケージバージョンの固定**:
  - Rの場合: `renv`を使用してパッケージバージョンを管理
  - Pythonの場合: `requirements.txt`または`pyproject.toml`でバージョンを明示

## 実験アプローチ
- 技術的な探索や実験を行う際には、以下のアプローチを採用してください。

### パッケージ・ライブラリの使用実験
- 小規模なデータセットやサンプルコードを使用して、概念や手法の検証を行います。
- 実験コードは、データの読み込み、前処理、分析、可視化の各ステップに分けて提供してください。
  - 各ステップには適切なコメントを追加し、コードの目的や手法について説明してください。
- 実験結果や考察については、グラフをpng形式で保存し、数表はcsv形式で保存できるようにしてください。

### 統計モデル・機械学習モデルの理論的な検証
- モデルの理論的な背景や数理的な性質について確認するために、私はCopilotにモデルの持つ特性や前提条件、適用範囲について説明します。
- この検証には、プログラムを使用してデータ生成過程(DGP)をシミュレートし、モデルを当てはめることでその妥当性を評価します。
  - スクリプトは、データ生成、モデルの適用、結果の評価で分けてください。
    - データ生成部分では、指定されたDGPに基づいてデータを生成するコードを提供してください。
    - モデルの適用部分では、生成されたデータに対して指定された統計モデルや機械学習モデルを適用するコードを提供してください。
    - 結果の評価部分では、モデルの性能を評価するための指標や可視化手法を用いたコードを提供してください。
    - 関数化やクラス化は最小限で問題ありませんが、コードの可読性を考慮して適切なコメントを追加してください。
- 実験結果や考察については、グラフをpng形式で保存し、数表はcsv形式で保存できるようにしてください。